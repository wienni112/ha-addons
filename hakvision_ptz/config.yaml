name: Hakvision PTZ Server
version: "0.2.4"
slug: hakvision_ptz
description: MQTT-to-Hikvision ISAPI PTZ control server
url: https://github.com/wienni112/ha-addons
arch:
  - amd64
  - aarch64
  - armv7

startup: services
boot: auto
init: false

hassio_api: true
homeassistant_api: false

# ensure MQTT is available when using core-mosquitto
services:
  mqtt: need

map:
  - addon_config:rw

options:
  mqtt_host: core-mosquitto
  mqtt_port: 1883
  mqtt_username: ""
  mqtt_password: ""
  mqtt_topic_prefix: "ptz"
  camera_id: "camera1"

  hikvision_host: "192.168.1.50"
  hikvision_port: 80
  hikvision_username: "admin"
  hikvision_password: "please-change-me"
  channel: 1

  # now interpreted as percent (0..100) because axes are -100..100
  deadzone: 5

  # optional speed multiplier for button-style commands (1..10)
  max_speed: 10
  default_speed: 5

  # smooth stop for joystick impulses without duration_ms
  smooth_stop_ms: 300

  # PTZ position status polling interval in seconds
  status_poll_s: 0.5

  log_level: "INFO"

schema:
  mqtt_host: str
  mqtt_port: int
  mqtt_username: str
  mqtt_password: password
  mqtt_topic_prefix: str
  camera_id: str

  hikvision_host: str
  hikvision_port: int
  hikvision_username: str
  hikvision_password: password
  channel: int

  deadzone: int
  max_speed: int
  default_speed: int
  smooth_stop_ms: int

  status_poll_s: float

  log_level: list(DEBUG|INFO|WARNING|ERROR)
